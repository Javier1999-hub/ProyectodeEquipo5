(window.agentWebpackJsonp=window.agentWebpackJsonp||[]).push([[7],{217:function(e,t,a){"use strict";var n=a(1);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(60),o=n(a(91)),r=a(273),c=(0,i.connect)(function(e){return e})((0,o.default)(r.Advert,"Advert"));t.default=c},221:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isEmail",{enumerable:!0,get:function(){return n.isEmail}}),Object.defineProperty(t,"isNumber",{enumerable:!0,get:function(){return n.isNumber}}),Object.defineProperty(t,"isURL",{enumerable:!0,get:function(){return n.isURL}});var n=a(223)},223:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isURL=t.isNumber=t.isEmail=void 0;t.isEmail=function(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)};t.isNumber=function(e){return/^([0-9])*$/.test(e)};t.isURL=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-/]))?/.test(e)}},273:function(e,t,a){"use strict";var n=a(1);Object.defineProperty(t,"__esModule",{value:!0}),t.Advert=void 0;var i=n(a(27)),o=n(a(28)),r=n(a(92)),c=n(a(58)),l=n(a(59)),d=n(a(40)),s=n(a(7)),u=n(a(5)),f=a(4),v=a(6),h=a(9),p=n(a(8)),m=a(221),g=a(16);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var a,n=(0,d.default)(e);if(t){var i=(0,d.default)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,l.default)(this,a)}}var k=!1,C="",b=function(e){(0,c.default)(a,e);var t=y(a);function a(e){var n;return(0,i.default)(this,a),(n=t.call(this,e)).handleClick=n.handleClick.bind((0,r.default)(n)),n.handleClose=n.handleClose.bind((0,r.default)(n)),n.handleOnLoad=n.handleOnLoad.bind((0,r.default)(n)),n.handleDragStart=n.handleDragStart.bind((0,r.default)(n)),n.handleHashChange=n.handleHashChange.bind((0,r.default)(n)),n.handleMouseUp=n.handleMouseUp.bind((0,r.default)(n)),n.state={clicked:!1},n}return(0,o.default)(a,[{key:"componentDidMount",value:function(){window.addEventListener("hashchange",this.handleHashChange),document.body&&document.body.addEventListener("mouseup",this.handleMouseUp)}},{key:"handleMouseUp",value:function(){var e=this;C=location.href;var t=function(){C!==location.href&&-1===location.href.indexOf("#")&&(C=location.href,e.handleHashChange())};setTimeout(function(){window.requestAnimationFrame?requestAnimationFrame(t):t()},500)}},{key:"componentDidUpdate",value:function(){var e=p.default.getChatElement(".".concat(v.KEY__ADVERT)),t=this.props.dispatch;function a(){var e=p.default.getChatElement(".aivochat-advert-content").height(),t=p.default.getChatElement(".aivochat-advert-text").height();if(t<e){var a=(e-t)/2;p.default.getChatElement(".aivochat-advert-text").css("top",a)}}if(e.length>0){var n=this.getAd();if(n){var i=1e3*parseInt(n.delay);setTimeout(function(){e.addClass("show"),k||(t((0,g.setAdvertView)(n.id)),k=!0)},i),(0,h.bringToFront)(e,"2147483645"),1===parseInt(n.proactivity_type_id)&&(e.find(".aivochat-advert-close").fadeIn(),setTimeout(function(){!function(e){e.css("font-size","");for(var t=parseInt(e.css("font-size").replace("px",""));e.height()>135&&t>1;)t-=1,e.css("font-size",t+"px"),a()}(e.find(".aivochat-advert-text"))},i))}}}},{key:"handleClick",value:function(e){e.preventDefault();var t=this.props.dispatch,a=this.props.agentConfig,n=this.getAd(),i={id:a.user.id,type:1};t((0,g.openWindow)()),t((0,g.sendMessage)(n.question,i,a.app.id)),t((0,g.setAdvertClick)(n.id)),this.setState({clicked:!0})}},{key:"handleClose",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({clicked:!0})}},{key:"handleDragStart",value:function(e){e.preventDefault()}},{key:"handleOnLoad",value:function(e){e.preventDefault()}},{key:"handleHashChange",value:function(){this.update(),this.setState({clicked:!1})}},{key:"getAd",value:function(){var e=this.props.agentConfig;return e.proactivities?e.proactivities[0]:void 0}},{key:"update",value:function(){var e=this,t=this.props,a=t.agentConfig,n=t.dispatch;p.default.getSettings(a.app.id,function(t){t.proactivity&&t.proactivities&&t.proactivities[0]&&(k=!1,e.setState({clicked:!1}),n((0,g.setConfig)({proactivities:t.proactivities})))})}},{key:"render",value:function(){var e=this,t=this.getAd(),a=function(a){switch(parseInt(a)){case 1:return s.default.createElement("div",{className:"aivochat-advert-content",style:{backgroundColor:t.color_background}},s.default.createElement("div",{className:"aivochat-advert-padding"},s.default.createElement("div",{className:"aivochat-advert-text",style:{color:t.color}},"".concat(t.welcome_message))),s.default.createElement("div",{className:"aivochat-advert-corner ".concat(t.image_location),style:{borderBottomColor:t.color_background}}),s.default.createElement("div",{className:"aivochat-advert-close",style:{color:t.color},onClick:e.handleClose},s.default.createElement("i",{className:"material-icons"},"close")));case 2:return s.default.createElement("div",{className:"aivochat-advert-content"},s.default.createElement("img",{className:"aivochat-advert-image",src:(0,m.isURL)(t.image_url)?t.image_url:"".concat(f.MkDpw5Y,"/").concat(t.image_url),onLoad:e.handleOnLoad,onDragStart:e.handleDragStart}),s.default.createElement("div",{className:"aivochat-advert-close",style:{color:t.color},onClick:e.handleClose},s.default.createElement("i",{className:"material-icons"},"close")),s.default.createElement("div",{className:"aivochat-advert-padding"}));default:return s.default.createElement("div",null)}};return s.default.createElement("div",null,function(){if(!e.state.clicked&&void 0!==t&&void 0!==t.proactivity_type_id){var n=1===parseInt(t.proactivity_type_id)?"text":"image";return s.default.createElement("div",{className:"".concat(v.KEY__ADVERT," ").concat(n," ").concat(t.image_location),onClick:e.handleClick},a(t.proactivity_type_id))}}())}}]),a}(s.default.Component);t.Advert=b,b.propTypes={agentConfig:u.default.object,dispatch:u.default.func}}}]);